<ol> <li>Ağ kablosunu yönlendiricinin LAN1 bağlantı noktasına bağlayın.</li> <li>SSH aracılığıyla root olarak oturum açın (yönlendirici IP'si, bağlantı noktası 20001, şifre - web arayüzü şifreniz).</li> <li>Aşağıdaki komutu çalıştırın: <pre><code>fw_printenv | grep tp_boot_idx</code></pre> Eğer sonuç `tp_boot_idx=1` ise, web arayüzünü kullanarak MERCUSYS stok yazılımını yükleyin ve 2. adımdan başlayın. Aksi halde bir sonraki adıma geçin. </li> <li>/etc/hotplug.d/iface/65-iptv dosyasını düzenlemek için açın (örneğin, 2. adımda WinSCP ve SSH ayarlarını kullanarak).</li> <li> <h1>!/bin/sh'den sonra yeni bir satır ekleyin:</h1> <pre><code>telnetd -l /bin/login.sh</code></pre> </li> <li>65-iptv dosyasını kaydedin.</li> <li>Yönlendirici web arayüzünde IPTV/VLAN Etkinleştir onay kutusunu değiştirin ve kaydedin.</li> <li>Telnetd'nin çalıştığından emin olun: <pre><code>netstat -ltunp | grep 23</code></pre> </li> <li>Telnet aracılığıyla yönlendirici IP'sine, bağlantı noktası 23'e giriş yapın (kullanıcı adı ve şifre gerekmez).</li> <li>OpenWrt `initramfs-kernel.bin` dosyasını yönlendiricinin `/tmp` klasörüne yükleyin (örneğin, 2. adımda WinSCP ve SSH ayarlarını kullanarak veya aşağıdaki komutla): <pre><code>cat initramfs-kernel.bin | ssh -p 20001 root@YOUR_ROUTER_IP "cat > /tmp/initramfs-kernel.bin"</code></pre> Yönlendiricide SFTP olmadığından dosyayı basitçe SCP ile yükleyemezsiniz. </li> <li>Stok meşgul kutusu `ubiupdatevol` komutunu içermez. Bu nedenle, meşgul kutunun tam sürümünü yönlendiriciye indirip yüklememiz gerekiyor. Örneğin, ArchLinux'tan - <a href="https://archlinuxarm.org/packages/aarch64/busybox.pkg.tar.xz">busybox.pkg.tar.xz</a> dosyasını indirin, <pre><code>tar xvf busybox-1.36.1-1-aarch64.pkg.tar.xz</code></pre> ile paketini açın, ardından `usr/bin/busybox`'ı yönlendiricinin `/tmp` dizinine yükleyin ve telnet'te çalıştırın: <pre><code>cd /tmp chmod a+x busybox</code></pre> </li> <li>`initramfs-kernel.bin` boyutunu kontrol edin: <pre><code>du -h initramfs-kernel.bin</code></pre> </li> <li>Eski birimi silin ve uygun boyutta (initramfs-kernel.bin boyutundan büyük) yeni bir çekirdek birimi oluşturun: <pre><code>ubirmvol /dev/ubi0 -N kernel ubimkvol /dev/ubi0 -n 1 -N kernel -s 9MiB</code></pre> </li> <li>Flash'a OpenWrt `initramfs-kernel.bin` yazın: <pre><code>./busybox ubiupdatevol /dev/ubi0_1 /tmp/initramfs-kernel.bin</code></pre> </li> <li>OpenWrt initramfs'ı yeniden başlatın: <pre><code>reboot</code></pre> </li> <li>SSH aracılığıyla root olarak oturum açın (IP 192.168.1.1, bağlantı noktası 22).</li> <li>OpenWrt'a girdikten sonra env değişkenlerini ayarlayın (veya güncelleyin): <pre><code>fw_setenv baudrate 115200 fw_setenv bootargs "ubi.mtd=ubi0 console=ttyS0,115200n1 loglevel=8 earlycon=uart8250,mmio32,0x11002000 init=/etc/preinit" fw_setenv fdtcontroladdr 5ffc0e70 fw_setenv ipaddr 192.168.1.1 fw_setenv loadaddr 0x46000000 fw_setenv mtdids "spi-nand0=spi-nand0" fw_setenv mtdparts "spi-nand0:2M(boot),1M(u-boot-env),50M(ubi0),50M(ubi1),8M(userconfig),4M(tp_data)" fw_setenv netmask 255.255.255.0 fw_setenv serverip 192.168.1.2 fw_setenv stderr serial@11002000 fw_setenv stdin serial@11002000 fw_setenv stdout serial@11002000 fw_setenv tp_boot_idx 0</code></pre> </li> <li>OpenWrt `sysupgrade.bin` görüntüsünü yönlendiricinin `/tmp` dizinine yükleyin.</li> <li>Sysupgrade'i çalıştırın: <pre><code>sysupgrade -n /tmp/sysupgrade.bin</code></pre> </li> </ol>
